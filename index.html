<!doctype html>
<html lang="vi">
<head>
  <meta charset="utf-8" />
  <title>L√†m thi·ªáp 20/10</title>

  <!-- Fonts (h·ªó tr·ª£ ti·∫øng Vi·ªát) -->
  <link href="https://fonts.googleapis.com/css2?family=Noto+Serif:ital@0;1&family=Roboto:wght@300;400;700&display=swap" rel="stylesheet">

  <!-- html2pdf -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.9.2/html2pdf.bundle.min.js"></script>

  <style>
    body { font-family: Roboto, system-ui, Arial; display:flex; gap:30px; padding:30px; }
    .controls { width:320px; }
    label{display:block; margin:8px 0 4px; font-weight:600}
    input, textarea, select { width:100%; padding:8px; box-sizing:border-box; border-radius:6px; border:1px solid #ccc; }
    textarea{ resize:none; min-height:120px; font-family:inherit }
    button{ margin-top:10px; padding:10px 14px; background:#c27ba0; color:#fff; border:none; border-radius:6px; cursor:pointer }
    button.secondary{ background:#6b9bd6; }

    /* v√πng preview (m·∫´u thi·ªáp) */
    .preview-wrap { flex:1; display:flex; align-items:center; justify-content:center; }
    #thiep {
      width:760px; height:540px; padding:36px; box-sizing:border-box;
      border-radius:12px; box-shadow:0 6px 18px rgba(0,0,0,0.12);
      background: linear-gradient(180deg, #fff7f9 0%, #fff 100%);
      border:6px solid #e89bbc;
      position:relative;
      color:#222;
      overflow:hidden;
      background-image: url('https://c.pxhere.com/photos/08/09/heart_valentine_s_day_love_feeling_happiness_falling_in_love_colorful_heart_darling-675880.jpg!d');
      background-size: cover;
      background-position: center;
    }

    /* N·ªôi dung thi·ªáp */
    .title { font-family: "Noto Serif", serif; font-size:36px; color:#c27ba0; text-align:center; margin-bottom:14px }
    .recipient { font-size:20px; text-align:center; margin-top:6px; font-weight:600 }
    .lopban { font-size:18px; text-align:center; color:#555; margin-top:4px }
    .message { margin:28px auto 0; width:80%; text-align:center; white-space:pre-wrap; line-height:1.6; font-size:20px; color:#111 }
    .sign { position:absolute; right:36px; bottom:28px; font-size:16px; color:#444 }

    /* M·∫´u kh√°c nhau */
    .hong { background: linear-gradient(180deg,#fff7f9 0%, #fff 100%); border-color:#e89bbc; }
    .xanh { background: linear-gradient(180deg,#e6f7ff 0%, #f8feff 100%); border-color:#80bfff; }
    .vang { background: linear-gradient(180deg,#fffbe6 0%, #fffef6 100%); border-color:#d4a017; }

    /* overlay m·ªù khi d√πng ·∫£nh n·ªÅn */
    .overlay {
      position:absolute; inset:0; background:rgba(255,255,255,0.36); pointer-events:none;
    }

    /* responsive preview for smaller screens */
    @media(max-width:1100px){
      body{flex-direction:column}
      .controls{ width:100% }
      .preview-wrap{ width:100% }
      #thiep{ width:100%; height:420px }
    }
  </style>
</head>
<body>
  <div class="controls">
    <h3>Thi·∫øt l·∫≠p thi·ªáp</h3>

    <label for="mau">Ch·ªçn m·∫´u</label>
    <select id="mau">
      <option value="hong">üíñ H·ªìng nh·∫π</option>
      <option value="xanh">üíô Xanh pastel</option>
      <option value="vang">üíõ V√†ng t∆∞∆°i</option>
    </select>

    <label for="can">CƒÉn l·ªÅ ch·ªØ</label>
    <select id="can">
    <option value="giua">CƒÉn gi·ªØa</option>
    <option value="trai">CƒÉn tr√°i</option>
    <option value="phai">CƒÉn ph·∫£i</option>
    </select>


    <label for="ten">T√™n ng∆∞·ªùi nh·∫≠n</label>
    <input id="ten" placeholder="Nh·∫≠p t√™n ng∆∞·ªùi nh·∫≠n">

    <label for="lop">Nh·∫≠p l·ªõp c·ªßa b·∫°n</label>
    <input id="lop" type="text" placeholder="Nh·∫≠p l·ªõp b·∫°n ƒëang h·ªçc (VD: 10D6 ho·∫∑c D6)">

    <label for="content">L·ªùi ch√∫c</label>
    <textarea id="content" placeholder="Nh·∫≠p l·ªùi ch√∫c...">C√≥ nh·ªØng ng√†y d√π n·∫Øng hay m∆∞a, nh·ªØng ng√†y ng·ªìi nghe ti·∫øng c√¥ gi·∫£ng, ƒë√≥ l√† m·ªôt trong nh·ªØng k√Ω ·ª©c tu·ªïi h·ªçc tr√≤ th·∫≠t t∆∞∆°i ƒë·∫πp. D∆∞·ªõi m√°i tr∆∞·ªùng th√¢n y√™u, tr√™n con ƒë√≤ c·∫≠p b·∫øn tri th·ª©c, nh√¢n ng√†y 20/10: Con xin ch√∫c c√¥ lu√¥n m·∫°nh kh·ªèe, lu√¥n r·ª±c r·ª° ƒë·ªÉ ti·∫øp t·ª•c c√πng ch√∫ng con ƒëi ƒëi ti·∫øp nh·ªØng qu√£ng ƒë∆∞·ªùng ph√≠a tr∆∞·ªõc ƒë·ªÉ c·∫≠p b·∫øn tri th·ª©c.</textarea>

    <label for="bgfile">Upload ·∫£nh n·ªÅn</label>
    <input id="bgfile" type="file" accept="image/*">

    <div style="display:flex; gap:8px">
      <button onclick="updatePreview()">Xem tr∆∞·ªõc</button>
      <button class="secondary" onclick="exportPDF()">T·∫£i PDF</button>
    </div>

    <p style="margin-top:12px; font-size:13px; color:#555">
      T·∫£i ·∫£nh l√™n ƒë·ªÉ l√†m thi·ªáp nh√©!
    </p>
  </div>

  <div class="preview-wrap">
    <div id="thiep" class="hong">
      <div class="title">L·ªùi ch√∫c y√™u th∆∞∆°ng 20-10</div>
      <div id="lopban" class="lopban"></div>
      <div id="recipient" class="recipient"></div>
      <div id="message" class="message"></div>
      <div class="sign">‚Äî T·ª´ t·∫•m l√≤ng</div>
      <div class="overlay"></div>
    </div>
  </div>

<script>
  const elThiep = document.getElementById('thiep');
  const selectMau = document.getElementById('mau');
  const tenInput = document.getElementById('ten');
  const lopInput = document.getElementById('lop');
  const contentInput = document.getElementById('content');
  const recipientEl = document.getElementById('recipient');
  const lopban = document.getElementById('lopban');
  const messageEl = document.getElementById('message');
  const bgFileInput = document.getElementById('bgfile');
  const cantext = document.getElementById('can');
  function updatePreview(){
    const mau = selectMau.value;
    elThiep.classList.remove('hong','xanh','vang');
    elThiep.classList.add(mau);

    const cantextValue = cantext.value;  // <--- l·∫•y value ·ªü ƒë√¢y
    const alignMap = { giua: "center", trai: "left", phai: "right" };
    messageEl.style.textAlign = alignMap[cantextValue] || "center";

    const ten = tenInput.value.trim() || 'C√¥ Th√¢n M·∫øn';
    const msg = contentInput.value.trim() || 'Ch√∫c b·∫°n m·ªçi ƒëi·ªÅu t·ªët ƒë·∫πp.';
    const lop = lopInput.value.trim() || '10D6';

    recipientEl.textContent = `G·ª≠i ${ten},`;
    messageEl.textContent = msg;
    lopban.textContent = `G·ª≠i t·ª´ l·ªõp ${lop} th√¢n y√™u.`;
  }

  bgFileInput.addEventListener('change', (e)=>{
    const file = e.target.files[0];
    if(!file) return;
    const url = URL.createObjectURL(file);
    elThiep.style.backgroundImage = `url(${url})`;
    elThiep.style.backgroundSize = 'cover';
    elThiep.style.backgroundPosition = 'center';
    document.querySelector('#thiep .overlay').style.background = 'rgba(255,255,255,0.36)';
  });

  async function exportPDF() {
    updatePreview();
    const ten = tenInput.value.trim() || 'Thiep';

    const opt = {
      margin: 0, // kh√¥ng c·∫ßn l·ªÅ, full thi·ªáp
      filename: `ThiepChuc_${ten}.pdf`,
      image: { type: 'jpeg', quality: 0.98 },
      html2canvas: { scale: 2, useCORS: true, logging: false },
      jsPDF: { unit: 'px', format: [elThiep.offsetWidth, elThiep.offsetHeight], orientation: 'landscape' }
    };

    await new Promise(r => setTimeout(r, 120)); // ch·ªù font/load ·∫£nh
    html2pdf().set(opt).from(elThiep).save();
  }

  updatePreview();
</script>
</body>
</html>
